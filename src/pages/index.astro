---
import { getCollection } from 'astro:content';
import Header from '../components/Header.astro';

const allPosts = await getCollection('blog');
const sortedPosts = allPosts.sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Блог о разработке</title>
  <link rel="stylesheet" href="/src/styles/global.css">
</head>
<body>
  <Header active="articles" />
  <main>
    <div class="page-header">
      <h1>Мой блог о разработке</h1>
      <p>Статьи, уроки и мысли о коде.</p>
    </div>
    <section class="articles-grid">
      {sortedPosts.map(post => (
        <a href={`/blog/${post.slug}`} class="article-card">
          {post.data.image && <img src={post.data.image} alt="" class="article-card-image" />}
          <div class="article-card-content">
            <h2 class="article-card-title">{post.data.title}</h2>
            <p class="article-card-meta">
              <time datetime={post.data.pubDate.toISOString()}>
                {new Date(post.data.pubDate).toLocaleDateString('ru-RU', { year: 'numeric', month: 'long', day: 'numeric' })}
              </time>
            </p>
            <p class="article-card-excerpt">{post.data.description}</p>
            <div class="article-card-footer">
              <span>Читать далее &rarr;</span>
            </div>
          </div>
        </a>
      ))}
    </section>
  </main>
</body>
</html>
<style>
  .page-header {
    text-align: center;
    margin-bottom: 3rem;
  }
  .page-header h1 {
    font-size: 3rem;
    font-weight: 700;
  }
  .page-header p {
    font-size: 1.2rem;
    color: var(--muted-text-color);
    margin-top: 0.5rem;
  }
</style>
